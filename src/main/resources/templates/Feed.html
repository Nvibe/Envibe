<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org">

<head>
  <meta charset="UTF-8">
  <title>Envibe</title>
  <meta name="generator" content="Google Web Designer 8.0.3.0603">
  <meta data-template-name="gwd-EnvibeBackground">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <link rel="stylesheet" type="text/css" href="/assets/StyleSheet.css">
  <style type="text/css" id="gwd-text-style">
    p {
      margin: 0px;
    }
    h1 {
      margin: 0px;
    }
    h2 {
      margin: 0px;
    }
    h3 {
      margin: 0px;
    }
    a{
      text-decoration: none;
    }
  </style>
</head>

<body class="htmlNoPages">
  <div class="LeftColumn" id="LeftColumn">
    <div class="ItemRow" id="Row1">
      <a href="/ManageAccount" class="MyAccount"><span class="MyAccountText">My Account</span></a><br>
      <br>
      
      <p></p>
    </div>
  </div>
  <div class="ContentArea" id="ContentArea">
    <div class="InnerContentArea" id="InnerContentArea">
      <template id="UserContentTemplate">
        <div class="Bubble" id="ContentBubble">
          <div class="UserContent" id="UserContent">
            <p class="text-tool-feedback ContentText" id="ContentText"><br>
              
            </p>
          </div>
          <div class="UserInfo" id="UserInfo">
            <p class="UserNameStyle" id="UserNameText"><br>
              
            </p>
            <div class="ProfilePicture" id="ProfilePicture"></div>
            <svg data-gwd-shape="oval" preserveAspectRatio="none" viewBox="0 0 40 40" class="ProfileOutline">
              <ellipse cx="50%" cy="50%" rx="19.5" ry="19.5"></ellipse>
            </svg>
          </div>
        </div>
      </template>
    </div>
    <div class="NewComment" id="NewComment">
      <form action="#" th:action="@{/api/v1/feed/create}" method="post">
        <input type="text" id="CommentField" class="TextField" name="content" placeholder="What are you vibing to?" value="">
        <button id="CreateButton" class="CreateButton" type="submit">Create Post</button>
      </form>
    </div>
  </div>
  <div class="RightColumn" id="RightColumn">
   <div class="Logout" id="Row1_1">
      <a href="/logout" class="MyAccount"><span class="MyAccountText">Logout</span></a><br>
      <br>
      
      <p class=""></p>
    </div>
  </div>
  <script>
    class User {
      constructor(name, content) {
        this.name = name;
        this.content = content;
      }

    }

    function newElement(name, content) {
      let element = document.createElement('div');
      element.append(UserContentTemplate.content.cloneNode(true));
      element.childNodes[1].childNodes[3].childNodes[1].innerHTML = name;
      element.childNodes[1].childNodes[1].childNodes[1].innerHTML = content;
      let target = document.getElementById('InnerContentArea');
      target.append(element);
    }


    $.ajax({
      url: '/api/v1/feed/user?count=10&after=0',
      type: 'GET',
      dataType: 'json',
      error: function(xhr, statTxt, thrownTXT) {
        alert(xhr.status + statTxt)
      },
      success: function(data, txtStatus, xhr) {
        var i;
        for (i = 0; i < data.length - 1; i++) {
          newElement(data[i].username, data[i].content);
        }
        //alert( "status: " + txtStatus);
        alert(data.length);
        //alert(JSON.stringify(data));
      }
    });
  </script>
</body>

</html>